from .. import connection
from ndg.httpsclient.ssl_peer_verification import SUBJ_ALT_NAME_SUPPORT
from ndg.httpsclient.subj_alt_name import SubjectAltName as BaseSubjectAltName
from typing import Any

HAS_SNI = SUBJ_ALT_NAME_SUPPORT
orig_connection_ssl_wrap_socket = connection.ssl_wrap_socket

def inject_into_urllib3() -> None: ...
def extract_from_urllib3() -> None: ...

class SubjectAltName(BaseSubjectAltName):
    sizeSpec: Any = ...

class WrappedSocket:
    connection: Any = ...
    socket: Any = ...
    suppress_ragged_eofs: Any = ...
    def __init__(self, connection: Any, socket: Any, suppress_ragged_eofs: bool = ...) -> None: ...
    def fileno(self): ...
    def makefile(self, mode: Any, bufsize: int = ...): ...
    def recv(self, *args: Any, **kwargs: Any): ...
    def settimeout(self, timeout: Any): ...
    def sendall(self, data: Any) -> None: ...
    def shutdown(self) -> None: ...
    def close(self): ...
    def getpeercert(self, binary_form: bool = ...): ...
